# ============================================
# Investment Decision Router Configuration
# 投资决策路由配置 - 机器可读格式
# ============================================
# Version: 1.0
# 用途: 程序自动路由问题到相关投资人

version: "1.0"
last_updated: "2024-12"

# 默认投资人（无法匹配时使用）
default_investors:
  - warren_buffett
  - charlie_munger

# ============================================
# 关键词匹配规则（正则表达式）
# ============================================
keyword_patterns:
  # 估值相关
  valuation:
    pattern: "估值|值不值|贵不贵|便宜|低估|高估|PE|PB|PEG|DCF|内在价值|安全边际|市盈率|市净率"
    investors: [warren_buffett, seth_klarman, peter_lynch]
    weight: 0.9
  
  # 护城河相关
  moat:
    pattern: "护城河|竞争优势|壁垒|moat|品牌|网络效应|转换成本|规模效应"
    investors: [warren_buffett, charlie_munger]
    weight: 0.95
  
  # 宏观/周期
  macro:
    pattern: "宏观|周期|经济|GDP|通胀|利率|Fed|美联储|央行|衰退|扩张|滞胀"
    investors: [ray_dalio, stanley_druckenmiller, howard_marks]
    weight: 0.9
  
  # 流动性
  liquidity:
    pattern: "流动性|QE|QT|缩表|扩表|资产负债表|TGA|RRP|净流动性|印钞"
    investors: [stanley_druckenmiller, ray_dalio]
    weight: 0.95
  
  # 风险/泡沫
  risk:
    pattern: "风险|泡沫|崩盘|危机|做空|黑天鹅|尾部|对冲"
    investors: [michael_burry, howard_marks, charlie_munger]
    weight: 0.9
  
  # 心理偏误
  bias:
    pattern: "偏误|心理|FOMO|从众|贪婪|恐惧|过度自信|确认偏误|锚定"
    investors: [charlie_munger]
    weight: 0.95
  
  # 仓位管理
  position:
    pattern: "仓位|加仓|减仓|止损|凯利|Kelly|头寸|风险敞口"
    investors: [stanley_druckenmiller, ed_thorp, george_soros]
    weight: 0.9
  
  # 成长股
  growth:
    pattern: "成长股|PEG|增速|增长率|成长性|十倍股|tenbagger"
    investors: [peter_lynch, warren_buffett]
    weight: 0.9
  
  # 价值陷阱
  value_trap:
    pattern: "价值陷阱|便宜货|深度价值|困境|清算|破产"
    investors: [charlie_munger, seth_klarman, michael_burry]
    weight: 0.9
  
  # 特殊策略
  special:
    pattern: "并购|套利|分拆|困境债|激进|行动主义|13D"
    investors: [seth_klarman, carl_icahn]
    weight: 0.85
  
  # 量化
  quant:
    pattern: "量化|因子|统计|回测|alpha|beta|夏普|回撤"
    investors: [james_simons, cliff_asness, ed_thorp]
    weight: 0.9
  
  # 加密货币（链接到 Prompt 角色）
  crypto:
    pattern: "BTC|ETH|比特币|以太坊|加密|币|链上|DeFi|NFT|交易所|合约|永续"
    investors: [james_simons, ed_thorp]
    prompts: [crypto_trader]
    weight: 0.95
  
  # AI500 量化交易（NOFX 专用）
  ai500:
    pattern: "AI500|ai500|NOFX|nofx|OI排名|持仓量|K线量化|爆拉|做局|拉盘"
    investors: [george_soros, stanley_druckenmiller, ed_thorp, howard_marks, james_simons]
    prompts: [nofx_ai500_master]
    weight: 0.98
    description: "AI500 币种专用量化策略，融合五位大师智慧"

# ============================================
# 分类路由配置
# ============================================
categories:

  # ----- 一、选股决策 -----
  stock_selection:
    name: "选股决策"
    subcategories:
      
      moat:
        name: "护城河评估"
        keywords: ["护城河", "竞争优势", "壁垒", "moat", "品牌", "网络效应"]
        primary: [warren_buffett]
        secondary: [charlie_munger, seth_klarman]
        rules:
          - condition: "无法识别明确护城河"
            action: "PASS"
            reason: "无竞争优势"
          - condition: "护城河依赖单一因素"
            action: "CAUTION"
            reason: "可能是暂时性优势"
      
      growth_valuation:
        name: "成长股估值"
        keywords: ["成长股", "PEG", "增速", "成长性", "高增长"]
        primary: [peter_lynch]
        secondary: [warren_buffett]
        rules:
          - condition: "PEG < 0.5 AND 增速可持续"
            action: "BUY_SIGNAL"
            reason: "成长被低估"
          - condition: "PEG > 2"
            action: "OVERVALUED"
            reason: "为成长付太多溢价"
      
      deep_value:
        name: "深度价值/冷门"
        keywords: ["便宜", "冷门", "被抛售", "清算价值", "深度价值"]
        primary: [seth_klarman, michael_burry]
        secondary: [howard_marks]
        rules:
          - condition: "便宜因被动抛售 AND 基本面未变"
            action: "OPPORTUNITY"
            reason: "非理性卖压"
          - condition: "便宜因行业结构性衰退"
            action: "AVOID"
            reason: "价值陷阱"
      
      value_trap:
        name: "价值陷阱排除"
        keywords: ["价值陷阱", "便宜货", "为何便宜"]
        primary: [charlie_munger]
        secondary: [warren_buffett, seth_klarman]
        rules:
          - condition: "护城河被侵蚀 AND 无改善迹象"
            action: "VALUE_TRAP"
          - condition: "行业结构性衰退"
            action: "VALUE_TRAP"

  # ----- 二、宏观/择时 -----
  macro:
    name: "宏观/择时"
    subcategories:
      
      cycle_position:
        name: "经济周期定位"
        keywords: ["周期", "经济", "象限", "衰退", "扩张", "滞胀"]
        primary: [ray_dalio]
        secondary: [howard_marks, stanley_druckenmiller]
        rules:
          - condition: "增长↑ + 通胀↓"
            action: "RISK_ON"
            assets: ["股票", "公司债"]
          - condition: "增长↓ + 通胀↑"
            action: "STAGFLATION"
            assets: ["商品", "黄金", "TIPS"]
          - condition: "增长↓ + 通胀↓"
            action: "RECESSION"
            assets: ["长期国债", "现金"]
      
      liquidity:
        name: "流动性趋势"
        keywords: ["流动性", "QE", "QT", "Fed", "资产负债表", "TGA", "RRP"]
        primary: [stanley_druckenmiller]
        secondary: [ray_dalio]
        rules:
          - condition: "净流动性上升"
            action: "RISK_ON"
          - condition: "净流动性下降 AND 高估值"
            action: "REDUCE"
            reason: "双杀风险"
      
      currency:
        name: "货币/汇率"
        keywords: ["汇率", "货币", "外汇", "美元", "人民币"]
        primary: [george_soros]
        secondary: [stanley_druckenmiller]
      
      rate_turn:
        name: "利率转向"
        keywords: ["加息", "降息", "利率", "Fed", "转向", "pivot"]
        primary: [stanley_druckenmiller]
        secondary: [ray_dalio, howard_marks]

  # ----- 三、风险检查 -----
  risk:
    name: "风险检查"
    subcategories:
      
      bias_check:
        name: "心理偏误检查"
        keywords: ["偏误", "心理", "FOMO", "从众", "贪婪", "恐惧"]
        primary: [charlie_munger]
        secondary: []
        checklist:
          - "有确认偏误吗？只看利好信息？"
          - "有从众效应吗？因为大家都在买？"
          - "有过度自信吗？觉得比市场聪明？"
          - "有承诺一致性吗？不愿认错？"
      
      cycle_extreme:
        name: "周期极端判断"
        keywords: ["泡沫", "恐慌", "极端", "顶部", "底部"]
        primary: [howard_marks]
        secondary: [ray_dalio, michael_burry]
        rules:
          - condition: "恐慌抛售 + 估值极低"
            action: "BOTTOM_NEAR"
          - condition: "杠杆激增 + 散户涌入"
            action: "TOP_NEAR"
      
      bubble:
        name: "泡沫识别"
        keywords: ["泡沫", "崩盘", "做空", "危机"]
        primary: [michael_burry, charlie_munger]
        secondary: [howard_marks, george_soros]
        signals:
          - "估值需要信仰才能合理化"
          - "新指标取代传统估值"
          - "价值投资已死成为共识"
      
      stop_loss:
        name: "止损决策"
        keywords: ["止损", "认错", "割肉", "出场"]
        primary: [george_soros]
        secondary: [stanley_druckenmiller]
        rules:
          - condition: "买入论点不再成立"
            action: "STOP_LOSS_NOW"

  # ----- 四、组合配置 -----
  portfolio:
    name: "组合配置"
    subcategories:
      
      allocation:
        name: "资产配置"
        keywords: ["配置", "股债", "比例", "全天候"]
        primary: [ray_dalio]
        secondary: [howard_marks]
      
      cash:
        name: "现金比例"
        keywords: ["现金", "子弹", "dry powder"]
        primary: [seth_klarman]
        secondary: [howard_marks, warren_buffett]
        rules:
          - condition: "估值普遍高估"
            action: "RAISE_CASH"
          - condition: "恐慌抛售 + 优质资产便宜"
            action: "DEPLOY_CASH"
      
      concentration:
        name: "集中 vs 分散"
        keywords: ["集中", "分散", "持仓数量"]
        concentrated: [warren_buffett, stanley_druckenmiller]
        diversified: [ray_dalio]
        rules:
          - condition: "确信度极高"
            action: "CONCENTRATE"
          - condition: "确信度一般 OR 宏观不确定"
            action: "DIVERSIFY"
      
      position_sizing:
        name: "仓位管理"
        keywords: ["仓位", "加仓", "减仓", "凯利", "Kelly"]
        primary: [stanley_druckenmiller, ed_thorp]
        secondary: [george_soros]
        rules:
          - condition: "确信度 90%+"
            action: "HEAVY_POSITION"
            size: "10-25%"
          - condition: "确信度 60-70%"
            action: "MEDIUM_POSITION"
            size: "3-7%"
          - condition: "确信度 < 50%"
            action: "SMALL_OR_NONE"

  # ----- 五、特殊策略 -----
  special:
    name: "特殊策略"
    subcategories:
      
      distressed:
        name: "困境债"
        keywords: ["困境债", "不良资产", "破产", "重组"]
        primary: [seth_klarman, howard_marks]
      
      merger_arb:
        name: "并购套利"
        keywords: ["并购", "收购", "套利", "价差"]
        primary: [seth_klarman]
      
      spinoff:
        name: "分拆套利"
        keywords: ["分拆", "剥离", "子公司"]
        primary: [peter_lynch, seth_klarman]
      
      activism:
        name: "股东行动主义"
        keywords: ["激进", "行动主义", "13D", "代理权"]
        primary: [carl_icahn]
      
      short:
        name: "做空"
        keywords: ["做空", "空头", "看跌"]
        primary: [michael_burry, george_soros]
      
      quant:
        name: "量化策略"
        keywords: ["量化", "因子", "统计", "回测"]
        primary: [james_simons, cliff_asness, ed_thorp]

# ============================================
# 快速路由表（问题 → 投资人）
# ============================================
quick_routes:
  - question: "这股票值得买吗"
    investors: [warren_buffett, charlie_munger, peter_lynch]
  - question: "现在该加仓还是减仓"
    investors: [howard_marks, stanley_druckenmiller, ray_dalio]
  - question: "市场是不是泡沫"
    investors: [charlie_munger, michael_burry, howard_marks]
  - question: "该持有多少现金"
    investors: [seth_klarman, howard_marks, warren_buffett]
  - question: "周期在哪个位置"
    investors: [ray_dalio, howard_marks]
  - question: "流动性怎么样"
    investors: [stanley_druckenmiller, ray_dalio]
  - question: "我的决策有偏误吗"
    investors: [charlie_munger]
  - question: "该如何做资产配置"
    investors: [ray_dalio]
  - question: "这是价值陷阱吗"
    investors: [charlie_munger, seth_klarman]
  - question: "该不该止损"
    investors: [george_soros, stanley_druckenmiller]
  - question: "仓位该多大"
    investors: [stanley_druckenmiller, ed_thorp]
  - question: "BTC/加密货币怎么看"
    investors: [prompts/crypto_trader]
  - question: "AI500怎么交易"
    investors: [prompts/nofx_ai500_master]
  - question: "OI排名怎么看"
    investors: [stanley_druckenmiller, prompts/nofx_ai500_master]
  - question: "K线+OI怎么分析"
    investors: [james_simons, prompts/nofx_ai500_master]

# ============================================
# 投资人元数据
# ============================================
investors:
  warren_buffett:
    name: "Warren Buffett"
    name_zh: "沃伦·巴菲特"
    style: ["value", "moat", "long_term"]
    doc: "warren_buffett.md"
  
  charlie_munger:
    name: "Charlie Munger"
    name_zh: "查理·芒格"
    style: ["mental_models", "contrarian", "bias_check"]
    doc: "charlie_munger.md"
  
  ray_dalio:
    name: "Ray Dalio"
    name_zh: "瑞·达利奥"
    style: ["macro", "cycle", "all_weather"]
    doc: "ray_dalio.md"
  
  stanley_druckenmiller:
    name: "Stanley Druckenmiller"
    name_zh: "斯坦利·德鲁肯米勒"
    style: ["macro", "liquidity", "concentrated"]
    doc: "stanley_druckenmiller.md"
  
  howard_marks:
    name: "Howard Marks"
    name_zh: "霍华德·马克斯"
    style: ["cycle", "risk", "distressed"]
    doc: "howard_marks.md"
  
  george_soros:
    name: "George Soros"
    name_zh: "乔治·索罗斯"
    style: ["macro", "reflexivity", "currency"]
    doc: "george_soros.md"
  
  peter_lynch:
    name: "Peter Lynch"
    name_zh: "彼得·林奇"
    style: ["growth", "peg", "consumer"]
    doc: "peter_lynch.md"
  
  seth_klarman:
    name: "Seth Klarman"
    name_zh: "塞斯·卡拉曼"
    style: ["deep_value", "distressed", "patient"]
    doc: "seth_klarman.md"
  
  michael_burry:
    name: "Michael Burry"
    name_zh: "迈克尔·伯里"
    style: ["contrarian", "bubble", "short"]
    doc: "michael_burry.md"
  
  carl_icahn:
    name: "Carl Icahn"
    name_zh: "卡尔·伊坎"
    style: ["activist", "event_driven"]
    doc: "carl_icahn.md"
  
  james_simons:
    name: "James Simons"
    name_zh: "詹姆斯·西蒙斯"
    style: ["quant", "statistical"]
    doc: "james_simons.md"
  
  ed_thorp:
    name: "Ed Thorp"
    name_zh: "爱德华·索普"
    style: ["quant", "kelly", "risk_management"]
    doc: "ed_thorp.md"
  
  cliff_asness:
    name: "Cliff Asness"
    name_zh: "克里夫·阿斯尼斯"
    style: ["quant", "factor", "value_momentum"]
    doc: "cliff_asness.md"

# ============================================
# Prompt 角色
# ============================================
prompt_roles:
  crypto_trader:
    name: "专业加密交易员"
    keywords: ["BTC", "ETH", "加密", "币", "链上", "DeFi"]
    doc: "prompts/crypto_trader.md"
  
  valuation_philosopher:
    name: "估值哲学家"
    keywords: ["DCF", "假设", "信仰", "模型"]
    doc: "prompts/valuation_philosopher.md"
  
  cycle_wizard:
    name: "周期巫师"
    keywords: ["周期", "转折", "拐点"]
    doc: "prompts/cycle_wizard.md"
  
  risk_hunter:
    name: "风险猎人"
    keywords: ["黑天鹅", "尾部", "极端"]
    doc: "prompts/risk_hunter.md"
  
  contrarian_prophet:
    name: "逆向先知"
    keywords: ["逆向", "共识", "反向"]
    doc: "prompts/contrarian_prophet.md"
  
  liquidity_shaman:
    name: "流动性萨满"
    keywords: ["流动性", "Fed", "资金"]
    doc: "prompts/liquidity_shaman.md"
  
  nofx_ai500_master:
    name: "AI500 量化大师"
    keywords: ["AI500", "NOFX", "OI排名", "K线量化", "持仓量", "做局", "拉盘"]
    doc: "prompts/nofx_ai500_master.md"
    description: "融合 Soros/Druckenmiller/Thorp/Marks/Simons 五位大师智慧的 AI500 专用策略"
    investor_sources: [george_soros, stanley_druckenmiller, ed_thorp, howard_marks, james_simons]

