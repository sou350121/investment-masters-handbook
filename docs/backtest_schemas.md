# Backtest Data Schemas

This document defines the input data formats required for the biweekly backtesting engine.

## 1. Historical News Briefs (`news_csv`)

Used for **Mode A** (Committee) and **Mode AB**. This file contains the market context provided to the LLM committee for each rebalancing period.

| Column | Type | Description |
| :--- | :--- | :--- |
| `as_of_date` | YYYY-MM-DD | The date of the brief. If this is not a trading day, the engine will use it as the context for the *next* available trading day. |
| `brief_text` | String | The summary of market news, macro data, and events for the preceding period. |
| `source` | String (Optional) | Source of the brief (e.g., "Bloomberg", "Internal"). |

**Example `news.csv`**:
```csv
as_of_date,brief_text,source
2024-01-02,"Market starts the year with tech rally. Inflation data remains sticky. Fed hints at steady rates.","Internal"
2024-01-16,"Earnings season begins with mixed bank results. VIX is at multi-year lows. Credit spreads narrowing.","Internal"
```

## 2. Strategy Signals (`signals_csv`)

Used for **Mode B** (Strategy-Combo) and **Mode AB**. This file contains the strategy recommendations typically generated by a quantitative backtest/optimizer.

| Column | Type | Description |
| :--- | :--- | :--- |
| `as_of_date` | YYYY-MM-DD | The date of the signal. |
| `best_combo` | JSON String | A JSON mapping of strategy names to weights (e.g., `{"TrendFollowing": 0.6, "Value": 0.4}`). |
| `risk_bias` | Float | Value between -1.0 (Defensive) and +1.0 (Aggressive). |
| `confidence` | Float | Value between 0.0 and 1.0 representing signal strength. |

**Example `signals.csv`**:
```csv
as_of_date,best_combo,risk_bias,confidence
2024-01-02,"{""TrendFollowing"": 0.6, ""QualityValue"": 0.4}",0.25,0.70
2024-01-16,"{""TrendFollowing"": 0.4, ""DefensiveCarry"": 0.6}",-0.10,0.65
```

## 3. Backtest Outputs

The engine generates the following files in `results/<run_id>/`:
- `allocations_A.csv` / `allocations_B.csv`: Historical target weights.
- `equity_curve_A.csv` / `equity_curve_B.csv`: Cumulative return series.
- `metrics_A.json` / `metrics_B.json`: Performance summary (Sharpe, CAGR, MaxDD).
- `comparison.md`: A/B comparison report.

